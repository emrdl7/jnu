(function($){"use strict";if(!String.prototype.hashCode){String.prototype.hashCode=function(){let hash=0,i,chr;if(this.length===0)return hash;for(i=0;i<this.length;i++){chr=this.charCodeAt(i);hash=(hash<<5)-hash+chr;hash|=0}return hash}}if(!String.prototype.startsWith){String.prototype.startsWith=function(search,pos){return this.substr(!pos||pos<0?0:+pos,search.length)===search}}if(!String.prototype.endsWith){String.prototype.endsWith=function(searchString,position){const subjectString=this.toString();if(typeof position!=="number"||!isFinite(position)||Math.floor(position)!==position||position>subjectString.length){position=subjectString.length}position-=searchString.length;const lastIndex=subjectString.indexOf(searchString,position);return lastIndex!==-1&&lastIndex===position}}if(!Number.prototype.format){Number.prototype.format=function(){if(this===0)return 0;const reg=/(^[+-]?\d+)(\d{3})/;let n=this+"";while(reg.test(n))n=n.replace(reg,"$1"+","+"$2");return n}}let supportsPassive=false;try{let opts=Object.defineProperty({},"passive",{get:function(){supportsPassive=true}});window.addEventListener("testPassive",null,opts);window.removeEventListener("testPassive",null,opts)}catch(e){}let $formReceiver=$("#formReceiver"),_submitButtons=[],_addedMyValidator=false,_popupSpecs=["width","height","scrollbars","resizable","menubar","status","toolbar","top","left","url"],_defaultPopupOptions={width:1e3,height:900,scrollbars:"yes",resizable:"yes",menubar:"no",status:"no",toolbar:"no",top:"center",left:"center"},_URI=new URI;if(!_.has(window,"_CONF"))window["_CONF"]={};window.initTooltipPopover=function(){$("[data-tooltip]").tooltip({container:"body",trigger:"hover",title:function(){let $this=$(this);if($this.data("tooltip"))return $(this).data("tooltip");return $(this).attr("title")}});$("[data-popover]").popover({container:"body"})};window.initCollapse=function(){$("a[data-collapse],button[data-collapse]").each(function(i,el){let $el=$(el);console.log($el.html());if(!$el.hasClass("init-collapse")){$el.addClass("init-collapse");let $target=$($el.data("collapse"));$target.collapse({toggle:false});$el.on("click",function(){$target.collapse("toggle")});$target.on("show.bs.collapse",function(e){let $icon=$el.find("i.fas");$icon.addClass("fa-caret-up").removeClass("fa-caret-down")});$target.on("hide.bs.collapse",function(e){let $icon=$el.find("i.fas");$icon.addClass("fa-caret-down").removeClass("fa-caret-up")})}})};function _enableSubmitButtons(){_.each(_submitButtons,function($btn){$btn.prop("disabled",false).html($btn.data("btntext"))})}window.enableSubmitButtons=_enableSubmitButtons;window.initFormValidate=function(){let $parsleys=$(".form-validate");if($parsleys.length>0){if(!_addedMyValidator){_addedMyValidator=true;window.Parsley.addValidator("code",{requirementType:"string",validateString:function(value,_requirement){return/^[a-zA-Z0-9]?[a-zA-Z_0-9\.]*$/.test(value)},messages:{ko:"영문자,숫자,_ 만 입력가능"}});window.Parsley.addValidator("userid",{requirementType:"string",validateString:function(value,_requirement){return/^[a-zA-Z0-9]+$/.test(value)},messages:{ko:"영문,숫자 만 입력가능"}});window.Parsley.addValidator("pwd",{requirementType:"string",validateString:function(value,_requirement){return/^(?=.*?[a-zA-Z])(?=.*?[0-9])(?=.*?[\!@#$%\^\&\*\(\)]).{9,20}$/.test(value)},messages:{ko:"하나이상의 영문,숫자,특수문자 [!@#$%^&*()], 길이 9~20"}});window.Parsley.addValidator("tel",{requirementType:"string",validateString:function(value,_requirement){return/^0[0-9]{1,2}\-?[0-9]{3,4}\-?[0-9]{4}$/.test(value)},messages:{ko:"전화번호 양식이 아닙니다."}});window.Parsley.addValidator("mobile",{requirementType:"string",validateString:function(value,_requirement){return/^01[0671]\-?[0-9]{3,4}\-?[0-9]{4}$/.test(value)},messages:{ko:"휴대전화 양식이 아닙니다."}});window.Parsley.addValidator("dir",{requirementType:"string",validateString:function(value,_requirement){return/^[a-zA-Z0-9\-/]*$/.test(value)},messages:{ko:"디렉토리에 가능한값이 아닙니다."}});window.Parsley.addValidator("ip",{requirementType:"string",validateString:function(value,_requirement){return/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.?[0-9]*$/.test(value)},messages:{ko:"아이피 값이 아닙니다."}});window.Parsley.addValidator("jumin",{requirementType:"string",validateString:function(value,requirement){return/^[0-9]{6}$/.test(value)&&/^[0-9]{7}$/.test($(requirement).val())},messages:{ko:"주민번호 형식이 아닙니다."}})}$parsleys.each(function(i,form){let $parsleyForm=$(form);if(!$parsleyForm.hasClass("init-validate")){$parsleyForm.addClass("init-validate");let data=$parsleyForm.data();if(!_.has(data,"submit")){$parsleyForm.find('button[type="submit"]').each(function(i,btn){let $btn=$(btn);if(!$btn.data("btntext")){$btn.data("btntext",$btn.html());_submitButtons.push($btn);$parsleyForm.data("submit",$btn)}})}else{let $btn=$(data.submit);if(!$btn.data("btntext")){$btn.data("btntext",$btn.html());_submitButtons.push($btn);$parsleyForm.data("submit",$btn)}}$parsleyForm.parsley({namespace:"data-v-",excluded:"[disabled]"}).on("form:submit",function(e){let $submitButton=e.$element.data("submit");if($submitButton){$submitButton.prop("disabled",true).html($submitButton.data("loading")||"처리중 ...");$(".is-invalid").removeClass("is-invalid").parent().find(".invalid-feedback").remove()}return true});if(!$parsleyForm.hasClass("form-validate-no-icon")){$parsleyForm.find("[required]").each(function(i,el){let $label=$(el).parent().prev();if($label[0]&&$label[0].tagName=="LABEL"&&!$label.hasClass("required-label")){$label.addClass("required-label");$label.html($label.html()+' <i class="fas fa-exclamation text-danger"></i>')}})}}})}};function showError(title,msg){if(typeof msg==="undefined"){msg=title;title="확인"}swal(title,msg,"error")}window.showError=showError;function showQuestion(question,confirmText,funcOk,funcCancel){Swal.fire({title:question,showCancelButton:true,cancelButtonText:"아니오",confirmButtonText:confirmText,icon:"question",reverseButtons:true}).then(function(result){if(!_.isUndefined(funcOk)&&_.isFunction(funcOk)&&result.isConfirmed){funcOk()}if(!_.isUndefined(funcCancel)&&_.isFunction(funcCancel)&&result.isDismissed){funcCancel()}})}window.showQuestion=showQuestion;function showInfo(title,msg,func){if(typeof msg==="undefined"){msg=title;title="정보"}if(func){swal({title:title,text:msg,type:"info",showCancelButton:false,closeOnConfirm:true},func)}else{swal(title,msg,"info")}}window.showInfo=showInfo;function showConfirm(title,msg,func){swal({title:title,text:msg,type:"info",showCancelButton:true,confirmButtonClass:"btn-primary",confirmButtonText:"예",cancelButtonText:"아니오",closeOnConfirm:true},func)}window.showConfirm=showConfirm;window.startValidateError=function(){};window.setValidateError=function(field,msg){let $input=$("[name="+field+"]");$input.addClass("is-invalid");$input.parent().append($('<div class="invalid-feedback">'+msg+"</div>"))};window.endValidateError=function(){};window.initAjaxForm=function(){let $ajaxForms=$(".form-ajax");if($ajaxForms.length>0){$ajaxForms.each(function(i,ajaxForm){let $ajaxForm=$(ajaxForm);if(!$ajaxForm.hasClass("init-ajax-form")){$ajaxForm.addClass("init-ajax-form");$ajaxForm.ajaxForm({dataType:"json",beforeSubmit:function(arr,$form,option){let result={success:true};$form.trigger("ajax-before",result);if(!result.success){_enableSubmitButtons();return false}},success:function(data,status,xhr,$form){_enableSubmitButtons();$form.trigger("ajax-success",arguments)},error:function(){console.log("ajax-form-error",arguments);$ajaxForm.trigger("ajax-error",arguments)}})}})}};window.popup=function(passedData){let popupOptions=_.extend(_defaultPopupOptions,_.pick(passedData,_popupSpecs)),specs=[],data=_.omit(passedData,_popupSpecs);let height=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;let width=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;let systemZoom=width/window.screen.availWidth;if(popupOptions.top==="center"){let dualScreenTop=window.screenTop!==undefined?window.screenTop:window.screenY;popupOptions.top=(height-popupOptions.height)/2/systemZoom+dualScreenTop}if(popupOptions.left==="center"){let dualScreenLeft=window.screenLeft!==undefined?window.screenLeft:window.screenX;popupOptions.left=(width-popupOptions.width)/2/systemZoom+dualScreenLeft}_.each(popupOptions,function(v,k){specs.push(k+"="+v)});let url=new URI(_.has(popupOptions,"url")&&popupOptions.url?popupOptions.url:_URI.pathname());data=_.omit(data,["url","popup"]);url.setSearch(data);window.open(url.href(),"popup"+url.href().hashCode(),specs.join(", "))};window.initPopup=function(){let $popups=$("a[data-popup], button[data-popup]");if($popups.length>0){$popups.each(function(_i,popupEl){let $popup=$(popupEl);if(!$popup.hasClass("init-popup")){$popup.addClass("init-popup");$popup.on("click",function(e){e.preventDefault();let $el=$(this),data=$el.data();data.url=this.tagName==="A"?$el.attr("href"):data.popup;popup(data)})}})}};window.objectToQuery=function(passedData,startQ){let queries=[],data=passedData||{};_.each(data,function(v,k){queries.push(k+"="+encodeURIComponent(v))});if(queries.length===0)return"";return""+(startQ?"?":"")+queries.join("&")};window.queryToObject=function(queryString){if(!queryString)return JSON.parse("{}");return JSON.parse('{"'+decodeURI(queryString).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')};window._url=function(path){return _CONF.prefix+(path.startsWith("/")?"":"/")+path+_CONF.suffix};window.doForm=function(data){let url="";if($.type(data)==="object"){let path=_.has(data,"url")?data.url:(new URI).pathname(),query=objectToQuery(_.omit(data,["url"]),true);url=path+query}else if($.type(data)==="string"){url=data}$formReceiver.prop("src",url)};window.awin=function(passedData){let popupOptions=_.extend(_defaultPopupOptions,_.pick(passedData,_popupSpecs));let path=_.has(passedData,"url")?passedData.url:(new URI).pathname();let data=_.omit(passedData,_popupSpecs);let query=objectToQuery(data,true);let url=path+query;let hash="awin"+url.hashCode();let specs=[];_.each(popupOptions,function(v,k){specs.push(k+"="+v)});window.open(url,hash,specs.join(", "))};let delDefault={act:"index",cmd:"delOK"},delAlertDefault={title:"삭제하시겠습니까 ?",text:"선택한 데이터를 삭제합니다.\n관련된 모든 데이터도 함께 삭제되며,\n삭제된 데이터는 복구할 수 없습니다.",type:"question",showCancelButton:true,confirmButtonClass:"btn-danger",confirmButtonText:"예",cancelButtonText:"아니요",closeOnConfirm:false,closeOnCancel:true},confirmDefault={title:"확인",text:"맞습니까 ?",type:"question",showCancelButton:true,confirmButtonClass:"btn-primary",confirmButtonText:"예",cancelButtonText:"아니요",closeOnConfirm:true,closeOnCancel:true};window.doDel=function(passedData){let data=_.extend(delDefault,passedData||{}),alertOption=_.extend(delAlertDefault,data.delProperties||{});data=_.omit(data,"delProperties");swal(alertOption,function(isConfirm){if(isConfirm){doForm(data)}})};window.doConfirm=function(passedData){let data=_.extend(confirmDefault,passedData||{}),alertOption=_.extend(confirmDefault,data.confirmProps||{});data=_.omit(data,"confirmProps");alertOption=_.omit(data,"confirm");swal(alertOption,function(isConfirm){if(isConfirm&&data.confirm){data.confirm()}})};$(function(){$formReceiver.on("load",_enableSubmitButtons)});window.initFancybox=function(){let $links=$("a.fancybox");if($links.length>0){$links.each(function(i,fancy){let $fancy=$(fancy);if(!$fancy.hasClass("init-fancy")){$fancy.addClass("init-fancy");$fancy.fancybox({})}})}};window.newPopup=function(defaults,data){awin(_.extend(defaults,data||{}))};function swalObj(obj,func){let o={title:obj.title,html:obj.text.replace(/\n/g,"<br />"),icon:obj.type,reverseButtons:true,showCancelButton:obj.showCancelButton,customClass:{confirmButton:_.has(obj,"confirmButtonClass")?"ml-2 btn "+obj.confirmButtonClass:"btn btn-success",cancelButton:_.has(obj,"cancelButtonClass")?"btn "+obj.cancelButtonClass:"btn btn-secondary"},buttonsStyling:false,confirmButtonText:_.has(obj,"confirmButtonText")?obj.confirmButtonText:"확인",cancelButtonText:_.has(obj,"cancelButtonText")?obj.cancelButtonText:"취소"};if(_.has(obj,"allowOutsideClick")){o.allowOutsideClick=obj.allowOutsideClick}if(arguments.length==2){Swal.fire(o).then(function(result){if(result.isConfirmed){func(true)}else{func(false)}})}else if(arguments.length==1){Swal.fire(o)}}window.swal=function(title,msg,type){switch(arguments.length){case 1:if(_.isString(title)){swalObj({title:"확인",text:title,type:"info"},_.noop)}else if(_.isObject(title)){swalObj(title)}break;case 2:if(_.isString(title)){swalObj({title:title,text:msg,type:"info"})}else if(_.isObject(title)){swalObj(title,msg)}break;case 3:swalObj({title:title,text:msg,type:type},_.noop);break}};window.alert=function(msg,target){const focusTarget=target||null;console.log(focusTarget+" 으로 포커스");Swal.fire({title:"",html:msg.replace(/\n/g,"<br />"),icon:"info",confirmButtonText:"확인",focusConfirm:true}).then(function(){console.log(focusTarget+" 으로 포커스");if(focusTarget){$(focusTarget).trigger("focus")}})};window.initBytes=function(){let $bytes=$("textarea[data-bytes], input[data-bytes]");if($bytes.length>0){$bytes.each(function(i,el){let $byte=$(el),maxBytes=$byte.data("bytes");if(!$byte.hasClass("init-bytes")){$byte.addClass("init-bytes");let $byteInfo=$('<div class="form-text bytes-info text-right"></div>'),$byteInput=$('<span class="bytes-input text-success font-weight-bold">0</span>'),$byteMax=$('<span class="bytes-max"></span>');$byteMax.text(" / "+maxBytes.format()+" bytes");$byteInput.appendTo($byteInfo);$byteMax.appendTo($byteInfo);$byteInfo.appendTo($bytes.parent());$byte.on("focus keyup keydown blur",function(){let $this=$(this),inputed=$this.val(),inputBytes=0,holdInput="";for(let i=0;i<inputed.length;i++){let code=inputed.charCodeAt(i);if(code>128)inputBytes+=3;else inputBytes++;if(inputBytes<=maxBytes)holdInput+=inputed.charAt(i)}$byteInput.text(inputBytes.format()).removeClass("text-success text-danger").addClass(inputBytes>maxBytes-3?"text-danger":"text-success");if(inputBytes>=maxBytes){$this.val(holdInput)}})}})}};let _daterange_default={showDropdowns:true,timePicker:false,timePicker24Hour:true,timePickerIncrement:10,ranges:false,alwaysShowCalendars:true,autoApply:true,locale:{separator:" ~ ",applyLabel:"적용",cancelLabel:"비우기",customRangeLabel:"날짜선택",daysOfWeek:["일","월","화","수","목","금","토"],monthNames:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]}},_daterange_default_ranges={"하루":[moment(),moment()],"어제":[moment().subtract(1,"days"),moment().subtract(1,"days")],"최근 7일":[moment().subtract(6,"days"),moment()],"최근 30일":[moment().subtract(29,"days"),moment()],"이번달":[moment().startOf("month"),moment().endOf("month")],"지난달":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]};window.initDaterange=function(){let $ranges=$("input[data-daterange]");if($ranges.length>0){$ranges.each(function(i,el){let $el=$(el);if(!$el.hasClass("init-daterange")){$el.addClass("init-daterange").prop("readonly",true);let settings=_.extend(_.clone(_daterange_default),$el.data("daterange")||{});settings.locale.format=settings.timePicker?"YYYY-MM-DD HH:mm":"YYYY-MM-DD";if(settings.ranges){if(_.isBoolean(settings.ranges)){settings.ranges=_daterange_default_ranges}}$el.daterangepicker(settings);$el.on("cancel.daterangepicker",function(ev,picker){$el.val("")})}})}};window.initDatepicker=function(){$(".input-group.input-daterange").each(function(){let $this=$(this);if(!$this.hasClass("input-daterange-init")){$this.addClass("input-daterange-init");$this.datepicker({format:_.isUndefined($this.data("format"))?"yyyy-mm-dd":$this.data("format"),todayBtn:"linked",clearBtn:_.isUndefined($this.data("clear"))?false:$this.data("clear"),language:"ko",autoclose:true,todayHighlight:true,orientation:_.isUndefined($this.data("orientation"))?"auto":$this.data("orientation"),startDate:_.isUndefined($this.data("startDate"))?"":$this.data("startDate"),endDate:_.isUndefined($this.data("endDate"))?"":$this.data("endDate")})}});$(".input-group.date").each(function(){let $this=$(this);if(!$this.hasClass("input-date-init")){$this.addClass("input-date-init");$this.datepicker({format:_.isUndefined($this.data("format"))?"yyyy-mm-dd":$this.data("format"),todayBtn:"linked",clearBtn:_.isUndefined($this.data("clear"))?false:$this.data("clear"),language:"ko",autoclose:true,todayHighlight:true,orientation:_.isUndefined($this.data("orientation"))?"auto":$this.data("orientation"),startDate:_.isUndefined($this.data("startDate"))?"":$this.data("startDate"),endDate:_.isUndefined($this.data("endDate"))?"":$this.data("endDate")})}})};const _datetimeDefaultOption={showTodayButton:true,showClose:true,stepping:10,format:"YYYY-MM-DD HH:mm"};window.initDateTimePicker=function(){$(".intput-datetime").each(function(){const _this=$(this),_data=_this.data();if(!_this.hasClass("intput-datetime-init")){_this.addClass("intput-datetime-init");_this.datetimepicker(_.merge(_.clone(_datetimeDefaultOption),_data.dp||{}));if(_.has(_data,"enddate")){_this.on("dp.change",function(e){$(_data.enddate).data("DateTimePicker").minDate(e.date)})}if(_.has(_data,"startdate")){_this.on("dp.change",function(e){$(_data.startdate).data("DateTimePicker").maxDate(e.date)})}}})};$.fn.serializeObject=function(){let self=this,json={},push_counters={},patterns={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};this.build=function(base,key,value){base[key]=value;return base};this.push_counter=function(key){if(push_counters[key]===undefined){push_counters[key]=0}return push_counters[key]++};$.each($(this).serializeArray(),function(){if(!patterns.validate.test(this.name)){return}let k,keys=this.name.match(patterns.key),merge=this.value,reverse_key=this.name;while((k=keys.pop())!==undefined){reverse_key=reverse_key.replace(new RegExp("\\["+k+"\\]$"),"");if(k.match(patterns.push)){merge=self.build([],self.push_counter(reverse_key),merge)}else if(k.match(patterns.fixed)){merge=self.build([],k,merge)}else if(k.match(patterns.named)){merge=self.build({},k,merge)}}json=$.extend(true,json,merge)});return json};window.initSortableTable=function(){let $sortTables=$(".table-sort");if($sortTables.length>0){$sortTables.each(function(i,sortTable){let $sortTable=$(sortTable);if(!$sortTable.hasClass("init-sort-table")){$sortTable.addClass("init-sort-table");let $thead=$sortTable.find("thead > tr"),$tbody=$sortTable.find("tbody");$thead.prepend('<th><i class="fal fa-sort"></i></th>');$tbody.find("tr").each(function(i,tr){$(tr).prepend('<td><i class="fal fa-bars sortable-handle" style="cursor:move;"></i></td>')});let sortOptions={items:"> tbody > tr",handle:".sortable-handle",containment:$sortTable,update:function(e,ui){URI.duplicateQueryParameters=true;let uri=new URI;let params={cmd:"orders"};let $target=$(e.target),key=$target.data("pk"),keys=$target.data("pks"),addParams=$target.data("param");if(addParams){params=_.extend(params,addParams)}if(key){let values=[];$target.find("tbody tr").each(function(i,tr){values.push($(tr).data(key))});params[key+"[]"]=values}else{let keyNames=keys.split(",");_.each(keyNames,function(key){let values=[];$target.find("tbody tr").each(function(i,tr){values.push($(tr).data(key))});params[key+"[]"]=values})}uri.setSearch(params);console.log(uri.href());doForm(uri.href())}};_.extend(sortOptions,$sortTable.data()||{});$sortTable.sortable(sortOptions)}})}};window.initCheckableTable=function(){let $checkTables=$(".table-check");if($checkTables.length>0){let checkEnableButtons=function(){let $checkedInputs=$checkTables.find("tbody > tr > td.check-container > input.checker:checked");$($checkTables.data("button")).prop("disabled",$checkedInputs.length<=0)};$checkTables.each(function(i,checkTable){let $checkTable=$(checkTable);if(!$checkTable.hasClass("init-check-table")){$checkTable.addClass("init-check-table");let $thead=$checkTable.find("thead > tr"),$tbody=$checkTable.find("tbody"),$trs=$tbody.find("tr.has-data"),$checkTablebutton=$($checkTable.data("button"));if($checkTablebutton.length>0){$checkTablebutton.prop("disabled",true);$checkTablebutton.on("click",function(){let $thisButton=$(this),checkedDatas=[];$tbody.find("tr > td.check-container > input.checker:checked").each(function(){checkedDatas.push($(this).closest("tr").data())});$checkTable.trigger("btn-click",[checkedDatas,$thisButton])})}if($trs.length>0){$thead.prepend('<th class="check-trigger-container"><input type="checkbox" class="check-trigger" /></th>');$trs.each(function(i,tr){if(!$(tr).hasClass("no-checkable")){$(tr).prepend('<td class="check-container"><input type="checkbox" class="checker" name="'+$checkTable.data("name")+'" value="'+$(tr).data("value")+'" /></td>')}else{$(tr).prepend("<td></td>")}});$thead.find("th.check-trigger-container > input.check-trigger").on("click",function(){$trs.find("td.check-container > input.checker").prop("checked",$(this).is(":checked"));checkEnableButtons()});$trs.find("td.check-container > input.checker").on("click",checkEnableButtons)}}})}};if($.type($.fn.selectpicker)=="function"){$.fn.selectpicker.Constructor.DEFAULTS.deselectAllText="선택 해제";$.fn.selectpicker.Constructor.DEFAULTS.noneSelectedText="선택 안함";$.fn.selectpicker.Constructor.DEFAULTS.selectAllText="모두 선택";$.fn.selectpicker.Constructor.BootstrapVersion="4"}let _init_select_defaults={container:"body",showSubtext:true,dropdownAlignRight:"auto",style:"btn-secondary"};window.initSelect=function(){$("select.select").each(function(i,select){let $select=$(select);if(!$select.hasClass("init-select")){$select.addClass("init-select");$select.selectpicker(_.merge(_.clone(_init_select_defaults),$select.data()))}})};window.initLabelPicker=function(){let $labelPickers=$(".label-picker");$labelPickers.each(function(i,picker){let $picker=$(picker);if(!$picker.hasClass("init-label-picker")){$picker.addClass("init-label-picker");let data=$picker.data(),$labels=$picker.find("label"),$inputs=$labels.find("input[type=radio]"),$checkers=$labels.find(".checker");$checkers.html('<i class="fa fa-fw"></i>');if(data.value){$picker.find('input[value="'+data.value+'"]').prop("checked",true);$picker.find('input[value="'+data.value+'"]').next().html('<i class="fa fa-fw fa-check"></i>')}$labels.on("click",function(){$checkers.html('<i class="fa fa-fw"></i>');$inputs.prop("checked",false);$(this).find("input").prop("checked",true);$(this).find(".checker").html('<i class="fa fa-check"></i>')})}})};window.addwin=function(data){let defaults={act:"index",cmd:"add"};awin(_.extend(defaults,data||{}))};window.viewwin=function(data){let defaults={act:"index",cmd:"view"};awin(_.extend(defaults,data||{}))};window._initDataView=function(){let dataViews=$("[data-view]");dataViews.each(function(_,el){let $el=$(el);if(!$el.hasClass("init-data-view")){$el.addClass("init-data-view");$el.on("click",function(e){e.preventDefault();e.stopPropagation();let data=$(this).data("view");viewwin(data)})}})};let $viewModal=false;function initViewModal(option){let $modal=$($("#viewModalTemplate").html());$modal.find(".modal-title").html(option.title||'<i class="fal fa-check"></i> 상세');return $modal}window.editwin=function(data){let defaults={act:"index",cmd:"edit"};awin(_.extend(defaults,data||{}))};$(function(){$("[data-add]").on("click",function(e){e.preventDefault();e.stopPropagation();addwin($(this).data("add"))});_initDataView();$("[data-view-modal]").on("click",function(e){e.preventDefault();e.stopPropagation();let data=$(this).data("viewModal");let option=_.extend({act:"index",cmd:"view",_out:"body"},data||{});let $modal=initViewModal(option);let path=(new URI).pathname();let query=objectToQuery(option,true);let url=path+query;$modal.on("hidden.bs.modal",function(){$modal.remove()});$modal.on("show.bs.modal",function(){$modal.find(".modal-body").load(url,initUI)});$modal.modal()});$("[data-act]").on("click",function(e){e.preventDefault();e.stopPropagation();awin($(this).data("act"))});$("[data-edit]").on("click",function(e){e.preventDefault();e.stopPropagation();editwin($(this).data("edit"))});$("[data-del]").on("click",function(e){e.preventDefault();e.stopPropagation();doDel($(this).data("del"))});$("[data-flag]").on("click",function(e){e.preventDefault();e.stopPropagation();let defaults={act:"index",cmd:"toggle"};doForm(_.extend(defaults,$(this).data("flag")||{}))}).css("cursor","pointer");$("[data-setvalue]").on("click",function(e){e.preventDefault();e.stopPropagation();let defaults={act:"index",cmd:"setValue"};doForm(_.extend(defaults,$(this).data("setvalue")||{}))}).css("cursor","pointer");$("[data-do]").on("click",function(e){e.preventDefault();e.stopPropagation();doForm($(this).data("do"))}).css("cursor","pointer");$("[data-close]").on("click",function(e){e.preventDefault();e.stopPropagation();window.close()});$("[data-cancel]").on("click",function(e){e.preventDefault();e.stopPropagation();if(window.opener){window.close()}else{history.back()}});$("[data-confirm]").on("click",function(e){e.preventDefault();e.stopPropagation();const msg=$(this).data("msg")||"계속하시겠습니까 ?";const act=$(this).data("confirm");const data=_.omit($(this).data(),["confirm","msg"]);data.act=act;showConfirm("확인",msg,function(ok){if(ok){doForm(data)}})})});_.templateSettings={interpolate:/\{\{(.+?)\}\}/g};window.loadScript=function(src){return new Promise(function(resolve,reject){const script=document.createElement("script");script.src=src;script.async=true;script.onload=()=>resolve(script);script.onerror=()=>reject(new Error(`${src} 로드 중 오류`));document.body.append(script)})}})(jQuery);